(this["webpackJsonpfour-in-a-row-react"]=this["webpackJsonpfour-in-a-row-react"]||[]).push([[0],{153:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(10),o=n.n(i),s=(n(92),n(20)),u=n(8),l=n(9),c=n(13),h=n(14),m=n(15),g=n(31),d=n(6),f=n.n(d),p=n(22),v=function(){function e(){Object(u.a)(this,e)}return Object(l.a)(e,null,[{key:"formSeries",value:function(e,t){var n=f.a.flatten(f.a.range(e).map((function(e){return f.a.range(t-3).map((function(t){return f.a.range(4).map((function(n){return{x:e,y:t+n}}))}))}))),a=f.a.flatten(f.a.range(t).map((function(t){return f.a.range(e-3).map((function(e){return f.a.range(4).map((function(n){return{x:e+n,y:t}}))}))}))),r=f.a.flatten(f.a.range(0,t-3).map((function(t){return f.a.range(e-3).map((function(e){return f.a.range(4).map((function(n){return{x:e+n,y:t+n}}))}))}))),i=f.a.flatten(f.a.range(0,t-3).map((function(t){return f.a.range(e-3).map((function(e){return f.a.range(4).map((function(n){return{x:e+n,y:3+t-n}}))}))})));return[].concat(Object(p.a)(n),Object(p.a)(a),Object(p.a)(r),Object(p.a)(i))}},{key:"stringifyCell",value:function(e){return"".concat(e.x,",").concat(e.y)}},{key:"getLastCellAsString",value:function(e,t){var n=t,a=e[t].length-1;return"".concat(n,",").concat(a)}}]),e}(),y=n(3),k=["Give me your best shot!","you like that?","Failed to see this coming, ha?","Come on, show me what you got!"],b=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(c.a)(this,Object(h.a)(t).call(this,e))).factor=function(e){return Math.pow(e,n.board.length)+2*n.series.length},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"takeStep",value:function(){this.win()||this.blockLose()||this.have2WaysToWin()||this.block2WaysToLose()||this.takeSmartStep()}},{key:"takeSmartStep",value:function(){var e=this.getBestChoise();this.appendToColumn(e,this.mark),this.message=f.a.sample(k)}},{key:"getBestChoise",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.getScoreForPosition(this.aiLevel,this.mark,!0);return console.log(t),f.a.maxBy(this.getAvailableColumns(e),(function(e){return t[e]}))}},{key:"getScoreForPosition",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[],i=this.columnsRange.map((function(e){return n.onFillColumn(e,t,(function(){var t=v.getLastCellAsString(n.board,e);if(n.won(t))return 1;if(n.lost(t))return-1;var a=n.stateScore();return r[e]=a,0}))})),o=[].concat(r).sort((function(e,a){return t===n.mark?a-e:e-a})).slice(0,3),s=i.map((function(a,i){return n.onFillColumn(i,t,(function(){return 1===a?n.factor(e):-1===a?-n.factor(e):1===e?r[i]:o.includes(r[i])?n.getScoreForPosition(e-1,n.toggleMark(t)):-1/0}))}));return a?s:f.a.sum(s.filter((function(e){return e!==-1/0})))}},{key:"stateScore",value:function(){var e=this;return f.a.sumBy(this.series.filter((function(t){return t[e.mark]>0&&0===t[e.opponentMark]})),(function(t){return t[e.mark]}))-f.a.sumBy(this.series.filter((function(t){return 0===t[e.mark]&&t[e.opponentMark]>0})),(function(t){return t[e.opponentMark]}))}},{key:"onEveryAvailableStep",value:function(e,t){var n=this;return this.columnsRange.every((function(a){if(n.board[a].length===n.maxHeight)return!0;n.appendToColumn(a,e);var r=t();return n.removeFromColumn(a,e),r}))}},{key:"findStepMatching",value:function(e,t){var n=this;return this.columnsRange.find((function(a){if(n.board[a].length===n.maxHeight)return!1;n.appendToColumn(a,e);var r=t();return n.removeFromColumn(a,e),r}))}},{key:"findStepsMatching",value:function(e,t){var n=this;return this.columnsRange.filter((function(a){if(n.board[a].length===n.maxHeight)return!1;n.appendToColumn(a,e);var r=t();return n.removeFromColumn(a,e),r}))}},{key:"canWinCell",value:function(){var e=this;return this.findStepMatching(this.mark,(function(){return e.won()}))}},{key:"canWin",value:function(){return void 0!==this.canWinCell()}},{key:"canLoseCell",value:function(){var e=this;return this.findStepMatching(this.opponentMark,(function(){return e.lost()}))}},{key:"canLose",value:function(){return void 0!==this.canLoseCell()}},{key:"win",value:function(){var e=this.canWinCell();return void 0!==e&&(this.appendToColumn(e,this.mark),this.message="Got ya!"),void 0!==e}},{key:"blockLose",value:function(){var e=this.canLoseCell();return void 0!==e&&(this.appendToColumn(e,this.mark),this.message="Blocked ya!"),void 0!==e}},{key:"have2WaysToWin",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this.findStepMatching(this.mark,(function(){return!e.canLose()&&e.onEveryAvailableStep(e.opponentMark,(function(){return e.canWin()}))}));return void 0!==n&&t&&(this.appendToColumn(n,this.mark),this.message="Got ya in 2 ways!"),void 0!==n}},{key:"block2WaysToLose",value:function(){var e=this,t=this.findStepsMatching(this.mark,(function(){return void 0!==e.findStepMatching(e.opponentMark,(function(){return!e.canWin()&&e.onEveryAvailableStep(e.mark,(function(){return e.canLose()}))}))}));if(t.length>1){var n=this.getAvailableColumns(t);if(console.log({cellsToBlock:n,cellsToLose:t}),0===n.length)return!1;var a=this.getBestChoise(t);this.appendToColumn(a,this.mark),this.message="Blocked ya from 2 ways!"}return t.length>1}}]),t}(function(){function e(t){var n=this;Object(u.a)(this,e);var a=t.boardColumns,r=t.board,i=t.boardRows,o=t.aiMark,l=t.opponentMark,c=t.aiLevel,h=t.refs;if(this.board=r||f.a.range(a).map((function(e){return[]})),this.maxHeight=i,this.mark=o,this.opponentMark=l,this.aiLevel=c,h)Object.assign(this,h);else{var m=v.formSeries(this.board.length,this.maxHeight),g=new Map(m.map((function(e){var t;return[e,Object(s.a)((t={},Object(y.a)(t,n.mark,0),Object(y.a)(t,n.opponentMark,0),t),f.a.countBy(e,(function(e){return n.board[e.x][e.y]})))]})));this.series=m.map((function(e){return g.get(e)})),this.seriesByCell=f.a.range(4).map((function(e){return f.a.groupBy(m,(function(t){return v.stringifyCell(t[e])}))})).map((function(e){return f.a.mapValues(e,(function(e){return e.map((function(e){return g.get(e)}))}))})).reduce((function(e,t){return Object.keys(t).forEach((function(n){var a;n in e?(a=e[n]).push.apply(a,Object(p.a)(t[n])):e[n]=t[n]})),e}),{})}this.columnsRange=f.a.range(this.board.length)}return Object(l.a)(e,[{key:"appendToColumn",value:function(e,t){this.board[e].push(t),this.lastColumn=e,this.seriesByCell[v.getLastCellAsString(this.board,e)].forEach((function(e){return e[t]++}))}},{key:"removeFromColumn",value:function(e,t){this.seriesByCell[v.getLastCellAsString(this.board,e)].forEach((function(e){return e[t]--})),this.board[e].pop()}},{key:"isTie",value:function(){var e=this;return this.board.every((function(t){return t.length===e.maxHeight}))}},{key:"won",value:function(e){return this.wonByMark(e,this.mark)}},{key:"lost",value:function(e){return this.wonByMark(e,this.opponentMark)}},{key:"wonByMark",value:function(e,t){return e?this.seriesByCell[e].some((function(e){return 4===e[t]})):this.series.some((function(e){return 4===e[t]}))}},{key:"toggleMark",value:function(e){return e===this.mark?this.opponentMark:this.mark}},{key:"onFillColumn",value:function(e,t,n){if(this.isColumnFull(e))return 0;this.appendToColumn(e,t);var a=n();return this.removeFromColumn(e,t),a}},{key:"isColumnFull",value:function(e){return this.board[e].length===this.maxHeight}},{key:"onSwitchedMarks",value:function(e){var t=[this.opponentMark,this.mark];this.mark=t[0],this.opponentMark=t[1];var n=e(),a=[this.opponentMark,this.mark];return this.mark=a[0],this.opponentMark=a[1],n}},{key:"getAvailableColumns",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.columnsRange.filter((function(n){return!t.includes(n)&&e.board[n].length<e.maxHeight}))}}]),e}()),C=1,w=2,x={messageBoxHeightArithmetic:"".concat(10,"px + 2vmin"),messageBoxFontArithmetic:"".concat(5,"px + 2vmin")};g.a.div.withConfig({displayName:"Board",componentId:"i3xyz9-0"})(["width:calc(100% - ","px),height:calc(100% - ","px - (",")),backgroundColor:#7f7878,display:grid,gridTemplateColumns:repeat(7,1fr),gridTemplateRows:repeat(7,1fr),gridRowGap:10,gridColumnGap:10,padding:",""],20,20,x.messageBoxHeightArithmetic,10);var M=1,S=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(c.a)(this,Object(h.a)(t).call(this,e))).state={currentPlayer:M},n.setup(),n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"setup",value:function(){var e=this.props,t=e.meta,n=e.board;this.firstMark="x",this.secondMark="o",this.meta=t;var a={board:n||f.a.range(7).map((function(e){return[]})),boardColumns:7,boardRows:6};this.engineFirst=new b(Object(s.a)({},a,{opponentMark:this.secondMark,aiMark:this.firstMark,aiLevel:t.first.level})),this.engineSecond=new b(Object(s.a)({},a,{opponentMark:this.firstMark,aiMark:this.secondMark,aiLevel:t.second.level,refs:{series:this.engineFirst.series,seriesByCell:this.engineFirst.seriesByCell}})),window.engine=this.engineSecond,window._=f.a,window.userSteps=this.userSteps=[],this.height=a.boardRows,this.board=this.engineFirst.board,this.width=a.boardColumns,this.state={currentPlayer:M}}},{key:"render",value:function(){var e=this;this.meta!==this.props.meta&&this.restart();var t=!1;return this.currentEngine.lost()?(console.log("Player ".concat(this.nextPlayer()," Won!")),t=!0):this.currentEngine.isTie()?(console.log("It's a Tie!"),t=!0):this.isCurrentPlayerType(C)&&setTimeout((function(){e.currentEngine.takeStep(),e.setState({currentPlayer:e.nextPlayer()}),e.props.onMessage(e.nextEngine.message)}),0),r.a.createElement("div",{style:{width:"calc(100% - 20px)",height:"calc(100% - 20px - 15px - 2vmin)",backgroundColor:"#7f7878",display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gridTemplateRows:"repeat(7, 1fr)",gridRowGap:10,gridColumnGap:10,padding:10}},f.a.rangeRight(this.height).map((function(t){return e.board.map((function(e){return function(e){var t="x"===e?"red":"blue";return r.a.createElement("div",{key:f.a.random(1e9),style:{border:e?"0.9vw solid ".concat(t):"none",borderRadius:"100%",background:e?"x"===e?"radial-gradient(circle, red 60%,transparent 100%)":"radial-gradient(circle, blue 60%, violet 90%)":"gray"}})}(e[t])}))})).flat(),f.a.range(this.width).map((function(n){return e.button(n,t,e.nextEngine.lastColumn===n)})))}},{key:"restart",value:function(){this.setup()}},{key:"isCurrentPlayerType",value:function(e){return this.state.currentPlayer===M?this.meta.first.type===e:this.meta.second.type===e}},{key:"button",value:function(e,t,n){var a=this,i="x"===this.currentMark?"blue":"red";return r.a.createElement("button",{style:{borderRadius:"10px",background:t?"repeating-linear-gradient(45deg, black, ".concat(i," 100%)"):n?"repeating-linear-gradient(45deg, ".concat(i,", transparent 100%)"):"repeating-linear-gradient(45deg, black, transparent 100%)",color:"white",fontWeight:"bold",fontSize:"2.7vw"},key:e,onClick:function(){!t&&a.board[e].length<a.height&&a.isCurrentPlayerType(w)&&(a.userSteps.push(e),a.currentEngine.appendToColumn(e,a.currentMark),a.setState({currentPlayer:a.nextPlayer()}))}},e+1)}},{key:"nextPlayer",value:function(){return 3-this.state.currentPlayer}},{key:"currentEngine",get:function(){return this.state.currentPlayer===M?this.engineFirst:this.engineSecond}},{key:"nextEngine",get:function(){return this.state.currentPlayer===M?this.engineSecond:this.engineFirst}},{key:"currentMark",get:function(){return this.state.currentPlayer===M?this.firstMark:this.secondMark}}]),t}(r.a.Component);var j=n(86),E=n(85),O=(n(152),[{value:w,label:"Human"},{value:C,label:"AI"}]);function B(e){var t=e.children;return r.a.createElement("div",{style:{minWidth:120}},t)}function T(e){var t=e.children;return r.a.createElement("div",{style:{minWidth:200,color:"black"}},t)}function P(e){var t=e.children;return r.a.createElement("div",{style:{display:"flex",alignItems:"center"}},t)}function F(e){var t=e.data,n=e.turn,a=e.onChange,i=O.find((function(e){return e.value===t.type}));return r.a.createElement("div",{style:{textAlign:"left",padding:20,fontFamily:"arial"}},r.a.createElement(P,null,r.a.createElement(B,null,r.a.createElement("span",null,n+" Player:")),r.a.createElement(T,null,r.a.createElement(j.a,{value:i,onChange:function(e){return a({type:e.value,level:t.level||7})},options:O}))),i.value===C&&r.a.createElement("div",{style:{paddingTop:10}},r.a.createElement(P,null,r.a.createElement(B,null,r.a.createElement("label",null,"Level: ")),r.a.createElement(T,null,r.a.createElement(E.a,{min:1,max:8,value:t.level||7,dots:!0,onChange:function(e){return a({type:t.type,level:e})}})))))}var A=function(e){function t(e){var n;Object(u.a)(this,t);var a=(n=Object(c.a)(this,Object(h.a)(t).call(this,e))).props,r=a.first,i=a.second;return n.state={first:r,second:i},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.first,a=t.second,i=this.props,o=i.onChange,u=i.onRestart;return r.a.createElement("div",{style:{margin:20,backgroundColor:"#7f7878",display:"grid",gridTemplateColumns:"min-content",borderRadius:"30px",color:"white",fontWeight:"bold"}},r.a.createElement(F,{data:n,turn:"First",onChange:function(t){return e.setState(Object(s.a)({},e.state,{first:t}))&&o({first:t,second:a})}}),r.a.createElement(F,{data:a,turn:"Second",onChange:function(t){return e.setState(Object(s.a)({},e.state,{second:t}))&&o({first:n,second:t})}}),r.a.createElement("button",{style:{margin:20,paddingTop:10,paddingBottom:10,fontSize:25,fontFamily:"arial",fontWeight:"bold",color:"white",background:"repeating-linear-gradient(45deg, transparent, black, transparent 100%)",borderRadius:15},onClick:function(){return u(Object(s.a)({},e.state))}},"Restart"))}}]),t}(r.a.Component),L=g.a.div.withConfig({displayName:"PlayGameStyled__PlayGameContianer",componentId:"sc-18jymkw-0"})(["text-align:center;margin:auto;background-color:#282c34;min-height:100vh;max-height:100vh;min-width:100vw;display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;justify-content:center;"]),R=g.a.div.withConfig({displayName:"PlayGameStyled__MessageAndBoardContainer",componentId:"sc-18jymkw-1"})(["width:",";height:calc("," + ",");min-width:",";min-height:calc("," + ",");max-width:",";max-height:calc("," + ",");padding:10px;"],"40vmax","40vmax",x.messageBoxHeightArithmetic,"300px","300px",x.messageBoxHeightArithmetic,"600px","600px",x.messageBoxHeightArithmetic),W=g.a.div.withConfig({displayName:"PlayGameStyled__MessageBox",componentId:"sc-18jymkw-2"})(["padding:10px 0;width:100%;font-size:calc(",");min-height:calc(",");"],x.messageBoxFontArithmetic,x.messageBoxHeightArithmetic),H=g.a.p.withConfig({displayName:"PlayGameStyled__Message",componentId:"sc-18jymkw-3"})(["margin:0 0;color:white;font-weight:bold;min-height:calc(",");"],x.messageBoxFontArithmetic),G=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(c.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={meta:{first:{type:w},second:{type:C,level:7}},message:""},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.message,a=t.meta;return r.a.createElement(L,null,r.a.createElement(R,null,r.a.createElement(W,null,r.a.createElement(H,null,n)),r.a.createElement(S,{meta:a,onMessage:function(t){return e.atLeastOneHumanPlayer()&&e.setState(Object(s.a)({},e.state,{message:t}))}})),r.a.createElement(A,{first:a.first,second:a.second,onChange:function(e){},onRestart:function(t){return e.setState({meta:t,message:null})}}))}},{key:"atLeastOneHumanPlayer",value:function(){var e=this.state.meta,t=e.first,n=e.second;return t.type===w||n.type===w}}]),t}(r.a.Component);var I=function(){return r.a.createElement(G,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},87:function(e,t,n){e.exports=n(153)},92:function(e,t,n){}},[[87,1,2]]]);
//# sourceMappingURL=main.de7a27ab.chunk.js.map